<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graduation</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🎓</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&family=Playfair+Display:wght@700;900&display=swap"
        rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollToPlugin.min.js"></script>

    <style type="text/tailwindcss">
        @font-face {
            font-family: 'font_strong';
            src: url('/fonts/belgan-aesthetic.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }
        @layer base {
            html, body {
                overflow: hidden; 
            }
            body {
                font-family: 'Montserrat', sans-serif; 
                background-color: transparent !important; 
                background-image: url('data:image/svg+xml;utf8,<svg width="100" height="100" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="40" stroke="%23DEDED1" stroke-width="1" fill="none"/></svg>');
                background-size: 30px; 
                background-repeat: repeat;
                background-attachment: fixed; 
            }

            .full-screen-section {
                height: 100vh;
                width: 100vw;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                padding: 1.5rem; 
                text-align: center;
                position: relative; 
                z-index: 1; 
            }

            .gsap-hidden {
                opacity: 0;
                visibility: hidden;
            }
            .gsap-intro-hidden {
                opacity: 0;
                visibility: hidden;
            }

            .special-container {
                position: relative;
                border-radius: 2rem; 
                padding: 1.5rem;
                background-color: theme('colors.brand-lightest'); 
                box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.03); 
                overflow: hidden; 
                z-index: 2; 
            }

            .special-container::before {
                content: '';
                position: absolute;
                inset: -5px; 
                background: linear-gradient(45deg, theme('colors.brand-light'), theme('colors.brand-mid'), theme('colors.brand-lightest')); 
                border-radius: 2.2rem; 
                z-index: -1; 
                filter: blur(8px); 
                opacity: 0.7;
                transition: opacity 0.3s ease;
            }

            .special-container:hover::before {
                opacity: 1;
            }

            .special-button-container {
                position: relative;
                display: inline-flex; 
                align-items: center;
                justify-content: center;
                padding: 0.75rem 2.5rem; 
                cursor: pointer;
                border: none;
                background: none;
                transition: all 0.3s ease;
                filter: drop-shadow(0 4px 6px rgba(0,0,0,0.05));
                -webkit-tap-highlight-color: transparent; 
                min-height: 50px; 
                min-width: 220px; 
                z-index: 2; 
            }

            .special-button-svg {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 1; 
            }

            .special-button-bg {
                fill: url(#button-gradient); 
                transition: fill 0.3s ease;
            }

            .special-button-border {
                fill: none;
                stroke: theme('colors.brand-light'); 
                stroke-width: 2;
                transition: stroke 0.3s ease;
            }

            .special-button-text {
                position: relative; 
                z-index: 2;
                color: theme('colors.text-primary'); 
                font-weight: bold;
                font-size: 1rem;
                line-height: 1;
                padding: 0 1rem; 
            }

            .special-button-container:hover {
                transform: translateY(-2px);
                filter: drop-shadow(0 6px 10px rgba(0,0,0,0.1));
            }

            .special-button-container:hover .special-button-bg {
                fill: url(#button-gradient-hover); 
            }

            .special-button-container:hover .special-button-border {
                stroke: theme('colors.brand-lightest'); 
            }

            .special-button-gray .special-button-bg {
                fill: theme('colors.brand-light'); 
            }
            .special-button-gray .special-button-border {
                stroke: theme('colors.brand-mid'); 
            }
            .special-button-gray .special-button-text {
                color: theme('colors.text-secondary'); 
            }
            .special-button-gray:hover .special-button-bg {
                fill: theme('colors.brand-mid'); 
            }
            .special-button-gray:hover .special-button-border {
                stroke: theme('colors.text-secondary'); 
            }

            .special-input {
                @apply w-full px-4 py-2 border-2 rounded-xl transition-all duration-300;
                border-color: theme('colors.brand-light'); 
                background-color: theme('colors.bg-light'); 
                color: theme('colors.text-primary');
            }
            .special-input:focus {
                border-color: theme('colors.brand-dark'); 
                box-shadow: 0 0 0 3px rgba(182, 174, 159, 0.5); 
                outline: none;
            }
            .special-input::placeholder {
                color: theme('colors.brand-mid');
            }

            .parallelogram {
                clip-path: polygon(20% 0%, 100% 0%, 80% 100%, 0% 100%);
            }
            .gsap-huflit-hidden {
                opacity: 0;
                visibility: hidden;
            }

            #timeline-nav {
                @apply fixed left-0 top-1/2 -translate-y-1/2 z-40 ml-4 md:ml-6;
            }
            #timeline-nav ul {
                list-style: none;
                padding: 0;
                margin: 0;
            }
            .timeline-dot {
                @apply w-3 h-3 md:w-4 md:h-4 rounded-full transition-all duration-300 ease-in-out cursor-pointer;
                background-color: theme('colors.brand-mid'); 
                border: 2px solid theme('colors.brand-lightest');
                position: relative;
            }
            .timeline-dot:hover {
                background-color: theme('colors.brand-dark'); 
                transform: scale(1.2);
            }
            .timeline-dot.active {
                background-color: theme('colors.text-primary'); 
                transform: scale(1.5);
                border-color: theme('colors.brand-dark');
            }
            
            .dot-tooltip {
                @apply absolute left-full top-1/2 -translate-y-1/2 ml-3 px-3 py-1 rounded-md text-sm font-bold shadow-lg whitespace-nowrap;
                background-color: theme('colors.text-primary');
                color: theme('colors.bg-light');
                opacity: 0;
                visibility: hidden;
                transform: translateX(-10px);
                transition: all 0.3s ease;
                pointer-events: none; 
            }
            
            .timeline-dot:hover .dot-tooltip {
                opacity: 1;
                visibility: visible;
                transform: translateX(0);
            }

            #animated-bg {
                @apply fixed inset-0 z-[-2]; 
                background-color: theme('colors.bg-light');
            }
            #background-decorations {
                @apply fixed inset-0 z-[-1] pointer-events-none overflow-hidden; 
            }
            #background-decorations span {
                @apply absolute;
                color: theme('colors.brand-dark');
                opacity: 0.15; 
            }

            #custom-popup {
                @apply fixed inset-0 z-50 flex items-center justify-center p-4;
                background-color: rgba(0, 0, 0, 0.4);
            }
            #custom-popup .popup-box {
                @apply w-full max-w-sm p-6 rounded-3xl shadow-2xl;
                background-color: theme('colors.bg-light');
                border: 2px solid theme('colors.brand-dark');
            }
            #custom-popup .popup-title {
                @apply text-2xl font-bold mb-3;
                color: theme('colors.text-primary');
                font-family: theme('fontFamily.strong');
            }
            #custom-popup .popup-content {
                @apply text-base mb-6;
                color: theme('colors.text-secondary');
            }
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Montserrat', 'sans-serif'],
                        playfair: ['Playfair Display', 'serif'],
                        strong: ['font_strong', 'serif'],
                    },
                    colors: {
                        'bg-light': '#FCF9EA',
                        'brand-lightest': '#FBF3D1',
                        'brand-light': '#DEDED1',
                        'brand-mid': '#C5C7BC',
                        'brand-dark': '#B6AE9F',
                        'text-primary': '#4a453e',
                        'text-secondary': '#786c62',
                    },
                    borderRadius: {
                        '4xl': '2.5rem',
                    }
                }
            }
        }
    </script>
</head>

<body class="bg-bg-light text-text-primary">

    <div id="animated-bg"></div>
    <div id="background-decorations"></div>

    <nav id="timeline-nav">
        <ul class="flex flex-col gap-4">
            <li class="timeline-dot active" data-index="0">
                <span class="dot-tooltip">Intro</span>
            </li>
            <li class="timeline-dot" data-index="1">
                <span class="dot-tooltip">HUFLIT</span>
            </li>
            <li class="timeline-dot" data-index="2">
                <span class="dot-tooltip">Graduation</span>
            </li>
            <li class="timeline-dot" data-index="3">
                <span class="dot-tooltip">Future</span>
            </li>
        </ul>
    </nav>

    <svg width="0" height="0" style="position:absolute">
        <defs>
            <linearGradient id="button-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#C5C7BC" />
                <stop offset="100%" style="stop-color:#B6AE9F" />
            </linearGradient>
            <linearGradient id="button-gradient-hover" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#B6AE9F" />
                <stop offset="100%" style="stop-color:#C5C7BC" />
            </linearGradient>
        </defs>
    </svg>

    <!-- ===== TRANG INTRO ===== -->
    <section id="page-intro" class="full-screen-section">
        <div id="intro-icon" class="gsap-intro-hidden text-6xl mb-6">🎓</div>
        <h1 class="gsap-intro-hidden text-6xl md:text-8xl font-extrabold text-text-primary mb-10 font-strong">
            My Graduation
        </h1>
        <button id="start-app-btn" class="gsap-intro-hidden special-button-container">
            <svg class="special-button-svg" viewBox="0 0 244 60" preserveAspectRatio="none" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path class="special-button-bg"
                    d="M226.286 1H126.143L122 5.14286L117.857 1H17.7143C14.0754 1 11.0886 2.06219 8.76116 3.98884C6.43372 5.91549 4.85714 8.62299 4.85714 11.5714V48.4286C4.85714 51.377 6.43372 54.0845 8.76116 56.0112C11.0886 57.9378 14.0754 59 17.7143 59H117.857L122 54.8571L126.143 59H226.286C229.925 59 232.911 57.9378 235.239 56.0112C237.566 54.0845 239.143 51.377 239.143 48.4286V11.5714C239.143 8.62299 237.566 5.91549 235.239 3.98884C232.911 2.06219 229.925 1 226.286 1Z" />
                <path class="special-button-border"
                    d="M226.286 1H126.143L122 5.14286L117.857 1H17.7143C14.0754 1 11.0886 2.06219 8.76116 3.98884C6.43372 5.91549 4.85714 8.62299 4.85714 11.5714V48.4286C4.85714 51.377 6.43372 54.0845 8.76116 56.0112C11.0886 57.9378 14.0754 59 17.7143 59H117.857L122 54.8571L126.143 59H226.286C229.925 59 232.911 57.9378 235.239 56.0112C237.566 54.0845 239.143 51.377 239.143 48.4286V11.5714C239.143 8.62299 237.566 5.91549 235.239 3.98884C232.911 2.06219 229.925 1 226.286 1Z" />
            </svg>
            <span class="special-button-text">Bắt Đầu</span>
        </button>
    </section>

    <!-- ===== SECTION 2: TRANG HUFLIT (Đã đổi) ===== -->
    <section id="page-huflit" class="full-screen-section overflow-hidden">
        <div
            class="container mx-auto max-w-5xl w-full flex flex-col md:flex-row items-center justify-center gap-8 px-4">

            <div class="w-full md:w-1/2 lg:w-2/5 gsap-huflit-hidden">
                <img src="images/huflit-photo-1.png" alt="Trường HUFLIT"
                    class="w-full h-auto object-cover rounded-lg shadow-2xl parallelogram" style="max-height: 70vh;">
            </div>

            <div class="w-full md:w-1/2 lg:w-3/5 text-left md:pl-8">
                <h1 class="gsap-huflit-hidden text-4xl md:text-5xl font-extrabold text-text-primary mb-6">
                    "Cái duyên" HUFLIT :)))
                </h1>
                <p class="gsap-huflit-hidden text-lg text-text-secondary mb-4 leading-relaxed">
                    Đây là nơi t ăn dầm nằm dề suốt 4 năm. Trường được cái gắn liền với nhiều drama, bao gồm cả drama
                    mang cấp “toàn quốc”.
                </p>
                <p class="gsap-huflit-hidden text-lg text-text-secondary mb-4 leading-relaxed">
                    Fun fact: HUFLIT "bén duyên" từ lúc mới khởi công, dựng bảng tên trường (khoảng năm 2015-2016). Hồi
                    đó chỉ biết "Đại
                    học" là ngầu
                    nên nhắm tới, chứ cũng không biết trường gì. Sau này không nghĩ lại học chính cái trường đó luôn :))
                </p>

                <button id="to-home-from-huflit-btn" class="gsap-huflit-hidden special-button-container">
                    <svg class="special-button-svg" viewBox="0 0 244 60" preserveAspectRatio="none" fill="none"
                        xmlns="http://www.w3.org/2000/svg">
                        <path class="special-button-bg"
                            d="M226.286 1H126.143L122 5.14286L117.857 1H17.7143C14.0754 1 11.0886 2.06219 8.76116 3.98884C6.43372 5.91549 4.85714 8.62299 4.85714 11.5714V48.4286C4.85714 51.377 6.43372 54.0845 8.76116 56.0112C11.0886 57.9378 14.0754 59 17.7143 59H117.857L122 54.8571L126.143 59H226.286C229.925 59 232.911 57.9378 235.239 56.0112C237.566 54.0845 239.143 51.377 239.143 48.4286V11.5714C239.143 8.62299 237.566 5.91549 235.239 3.98884C232.911 2.06219 229.925 1 226.286 1Z" />
                        <path class="special-button-border"
                            d="M226.286 1H126.143L122 5.14286L117.857 1H17.7143C14.0754 1 11.0886 2.06219 8.76116 3.98884C6.43372 5.91549 4.85714 8.62299 4.85714 11.5714V48.4286C4.85714 51.377 6.43372 54.0845 8.76116 56.0112C11.0886 57.9378 14.0754 59 17.7143 59H117.857L122 54.8571L126.143 59H226.286C229.925 59 232.911 57.9378 235.239 56.0112C237.566 54.0845 239.143 51.377 239.143 48.4286V11.5714C239.143 8.62299 237.566 5.91549 235.239 3.98884C232.911 2.06219 229.925 1 226.286 1Z" />
                    </svg>
                    <span class="special-button-text">Tiếp theo</span>
                </button>
            </div>
        </div>
    </section>

    <!-- ===== SECTION 3: LỄ TỐT NGHIỆP (Đã đổi) ===== -->
    <section id="page-home" class="full-screen-section">
        <div class="max-w-2xl w-full">
            <h1 class="gsap-hidden gsap-title text-5xl md:text-6xl font-extrabold text-text-primary mb-8 font-strong">
                About My Graduation
            </h1>
            <p class="gsap-hidden gsap-intro text-lg md:text-xl text-text-secondary mb-8 leading-relaxed">
                "Mình" rất vui và vinh dự được mời quý dị đến chung vui trong buổi lễ tốt nghiệp.
                Ngoài ra thì vẫn sẽ có những buổi đi chơi riêng sau đó. Thông tin chi tiết sẽ liên hệ sau nha!
            </p>

            <div class="gsap-hidden gsap-details special-container mb-8 text-left space-y-4">
                <div class="flex items-center space-x-4">
                    <span class="text-text-primary text-3xl w-10 flex-shrink-0 text-center">🎓</span>
                    <p class="text-lg font-medium">Lễ Tốt Nghiệp của Phước - Bờm - Puu</p>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="text-text-primary text-3xl w-10 flex-shrink-0 text-center">📅</span>
                    <p class="text-lg font-medium">13:00 PM, ngày 30/10/2025</p>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="text-text-primary text-3xl w-10 flex-shrink-0 text-center">📍</span>
                    <a title="Địa chỉ tổ chức" class="text-lg font-medium underline"
                        href="https://maps.app.goo.gl/2KPg3cpQs4i5Ntz8A">
                        HUFLIT Cơ sở Hóc Môn
                    </a>
                </div>
            </div>

            <p class="gsap-hidden gsap-intro text-base text-text-secondary mb-8">
                À mà khoan! Trước khi xác nhận tham dự, có một trò chơi nhỏ sau đây...
            </p>

            <button id="to-game-btn" class="gsap-hidden gsap-button special-button-container">
                <svg class="special-button-svg" viewBox="0 0 244 60" preserveAspectRatio="none" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <path class="special-button-bg"
                        d="M226.286 1H126.143L122 5.14286L117.857 1H17.7143C14.0754 1 11.0886 2.06219 8.76116 3.98884C6.43372 5.91549 4.85714 8.62299 4.85714 11.5714V48.4286C4.85714 51.377 6.43372 54.0845 8.76116 56.0112C11.0886 57.9378 14.0754 59 17.7143 59H117.857L122 54.8571L126.143 59H226.286C229.925 59 232.911 57.9378 235.239 56.0112C237.566 54.0845 239.143 51.377 239.143 48.4286V11.5714C239.143 8.62299 237.566 5.91549 235.239 3.98884C232.911 2.06219 229.925 1 226.286 1Z" />
                    <path class="special-button-border"
                        d="M226.286 1H126.143L122 5.14286L117.857 1H17.7143C14.0754 1 11.0886 2.06219 8.76116 3.98884C6.43372 5.91549 4.85714 8.62299 4.85714 11.5714V48.4286C4.85714 51.377 6.43372 54.0845 8.76116 56.0112C11.0886 57.9378 14.0754 59 17.7143 59H117.857L122 54.8571L126.143 59H226.286C229.925 59 232.911 57.9378 235.239 56.0112C237.566 54.0845 239.143 51.377 239.143 48.4286V11.5714C239.143 8.62299 237.566 5.91549 235.239 3.98884C232.911 2.06219 229.925 1 226.286 1Z" />
                </svg>
                <span class="special-button-text">Khám Phá "Tương Lai"</span>
            </button>
        </div>
    </section>

    <!-- ===== SECTION 4: TRÒ CHƠI PRANK (Giữ nguyên) ===== -->
    <section id="page-game" class="full-screen-section">
        <div class="special-container w-full max-w-md">

            <div id="game-header" class="text-center mb-6">
                <h2 class="text-3xl font-extrabold text-text-primary mb-2 font-strong">
                    🔮 Future 🔮
                </h2>
                <p class="text-text-secondary">Để AI tự chế đoán tương lai</p>
            </div>

            <form id="game-form">
                <div class="space-y-4">
                    <div>
                        <label for="name" class="block text-sm font-medium text-text-secondary mb-1">Tên của bạn</label>
                        <input type="text" id="name" name="name" class="special-input" placeholder="Nguyễn Văn A"
                            required>
                    </div>
                    <div>
                        <label for="email" class="block text-sm font-medium text-text-secondary mb-1">Email</label>
                        <input type="email" id="email" name="email" class="special-input" placeholder="bancua@toi.com"
                            required>
                    </div>
                    <div>
                        <label for="age" class="block text-sm font-medium text-text-secondary mb-1">Tuổi hiện
                            tại</label>
                        <input type="text" id="age" name="age" class="special-input" placeholder="22" min="1" required
                            inputmode="numeric">
                    </div>
                </div>
                <button type="submit" class="special-button-container w-full mt-6">
                    <svg class="special-button-svg" viewBox="0 0 244 60" preserveAspectRatio="none" fill="none"
                        xmlns="http://www.w3.org/2000/svg">
                        <path class="special-button-bg"
                            d="M226.286 1H126.143L122 5.14286L117.857 1H17.7143C14.0754 1 11.0886 2.06219 8.76116 3.98884C6.43372 5.91549 4.85714 8.62299 4.85714 11.5714V48.4286C4.85714 51.377 6.43372 54.0845 8.76116 56.0112C11.0886 57.9378 14.0754 59 17.7143 59H117.857L122 54.8571L126.143 59H226.286C229.925 59 232.911 57.9378 235.239 56.0112C237.566 54.0845 239.143 51.377 239.143 48.4286V11.5714C239.143 8.62299 237.566 5.91549 235.239 3.98884C232.911 2.06219 229.925 1 226.286 1Z" />
                        <path class="special-button-border"
                            d="M226.286 1H126.143L122 5.14286L117.857 1H17.7143C14.0754 1 11.0886 2.06219 8.76116 3.98884C6.43372 5.91549 4.85714 8.62299 4.85714 11.5714V48.4286C4.85714 51.377 6.43372 54.0845 8.76116 56.0112C11.0886 57.9378 14.0754 59 17.7143 59H117.857L122 54.8571L126.143 59H226.286C229.925 59 232.911 57.9378 235.239 56.0112C237.566 54.0845 239.143 51.377 239.143 48.4286V11.5714C239.143 8.62299 237.566 5.91549 235.239 3.98884C232.911 2.06219 229.925 1 226.286 1Z" />
                    </svg>
                    <span class="special-button-text">Bắt đầu dự đoán!</span>
                </button>
            </form>

            <div id="loading-spinner" class="hidden text-center my-10">
                <p class="text-lg font-medium text-text-primary mb-4">✨ AI đang phân tích tương lai của bạn... ✨</p>
                <div class="w-full bg-brand-light rounded-full h-3 overflow-hidden shadow-inner">
                    <div id="loading-bar"
                        class="bg-gradient-to-r from-brand-mid to-brand-dark h-3 rounded-full shadow-md"
                        style="width: 0%"></div>
                </div>
                <p id="loading-text" class="text-sm text-text-secondary mt-2"></p>
            </div>

            <div id="game-result" class="hidden text-center my-10">
                <p class="text-xl text-text-secondary mb-2">Kết quả dự đoán của bạn là:</p>
                <p id="result-text" class="text-4xl font-extrabold text-text-primary animate-pulse"></p>
                <p class="text-text-primary font-semibold mt-6" id="email-confirm-msg" style="opacity: 0;">
                    (Đùa á :)) Kiểm tra hộp thư nha, kiểm tra cả mục "Promotion" hoặc "Spam" nếu không thấy gì hết! 📧)
                </p>
            </div>

            <button id="to-home-btn" class="hidden special-button-container special-button-gray w-full mt-8">
                <svg class="special-button-svg" viewBox="0 0 244 60" preserveAspectRatio="none" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <path class="special-button-bg"
                        d="M226.286 1H126.143L122 5.14286L117.857 1H17.7143C14.0754 1 11.0886 2.06219 8.76116 3.98884C6.43372 5.91549 4.85714 8.62299 4.85714 11.5714V48.4286C4.85714 51.377 6.43372 54.0845 8.76116 56.0112C11.0886 57.9378 14.0754 59 17.7143 59H117.857L122 54.8571L126.143 59H226.286C229.925 59 232.911 57.9378 235.239 56.0112C237.566 54.0845 239.143 51.377 239.143 48.4286V11.5714C239.143 8.62299 237.566 5.91549 235.239 3.98884C232.911 2.06219 229.925 1 226.286 1Z" />
                    <path class="special-button-border"
                        d="M226.286 1H126.143L122 5.14286L117.857 1H17.7143C14.0754 1 11.0886 2.06219 8.76116 3.98884C6.43372 5.91549 4.85714 8.62299 4.85714 11.5714V48.4286C4.85714 51.377 6.43372 54.0845 8.76116 56.0112C11.0886 57.9378 14.0754 59 17.7143 59H117.857L122 54.8571L126.143 59H226.286C229.925 59 232.911 57.9378 235.239 56.0112C237.566 54.0845 239.143 51.377 239.143 48.4286V11.5714C239.143 8.62299 237.566 5.91549 235.239 3.98884C232.911 2.06219 229.925 1 226.286 1Z" />
                </svg>
                <span class="special-button-text">Quay về trang chủ</span>
            </button>

        </div>
    </section>

    <!-- NEW: Custom Popup HTML -->
    <div id="custom-popup" class="hidden" style="display: none;">
        <div class="popup-box text-center">
            <h3 id="popup-title" class="popup-title"></h3>
            <p id="popup-content" class="popup-content"></p>
            <button id="close-popup-btn" class="special-button-container special-button-gray">
                <svg class="special-button-svg" viewBox="0 0 244 60" preserveAspectRatio="none" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <path class="special-button-bg"
                        d="M226.286 1H126.143L122 5.14286L117.857 1H17.7143C14.0754 1 11.0886 2.06219 8.76116 3.98884C6.43372 5.91549 4.85714 8.62299 4.85714 11.5714V48.4286C4.85714 51.377 6.43372 54.0845 8.76116 56.0112C11.0886 57.9378 14.0754 59 17.7143 59H117.857L122 54.8571L126.143 59H226.286C229.925 59 232.911 57.9378 235.239 56.0112C237.566 54.0845 239.143 51.377 239.143 48.4286V11.5714C239.143 8.62299 237.566 5.91549 235.239 3.98884C232.911 2.06219 229.925 1 226.286 1Z" />
                    <path class="special-button-border"
                        d="M226.286 1H126.143L122 5.14286L117.857 1H17.7143C14.0754 1 11.0886 2.06219 8.76116 3.98884C6.43372 5.91549 4.85714 8.62299 4.85714 11.5714V48.4286C4.85714 51.377 6.43372 54.0845 8.76116 56.0112C11.0886 57.9378 14.0754 59 17.7143 59H117.857L122 54.8571L126.143 59H226.286C229.925 59 232.911 57.9378 235.239 56.0112C237.566 54.0845 239.143 51.377 239.143 48.4286V11.5714C239.143 8.62299 237.566 5.91549 235.239 3.98884C232.911 2.06219 229.925 1 226.286 1Z" />
                </svg>
                <span class="special-button-text">OK, biết rồi</span>
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

            const startAppBtn = document.getElementById('start-app-btn');
            const toHomeFromHuflitBtn = document.getElementById('to-home-from-huflit-btn');
            const toGameBtn = document.getElementById('to-game-btn');
            const toHomeBtn = document.getElementById('to-home-btn');

            const gameForm = document.getElementById('game-form');
            const gameHeader = document.getElementById('game-header');
            const gameContainer = document.querySelector('#page-game .special-container');
            const loadingSpinner = document.getElementById('loading-spinner');
            const loadingBar = document.getElementById('loading-bar');
            const loadingText = document.getElementById('loading-text');
            const gameResult = document.getElementById('game-result');
            const resultText = document.getElementById('result-text');
            const emailConfirmMsg = document.getElementById('email-confirm-msg');

            const ageInput = document.getElementById('age');
            const popup = document.getElementById('custom-popup');
            const popupTitle = document.getElementById('popup-title');
            const popupContent = document.getElementById('popup-content');
            const closePopupBtn = document.getElementById('close-popup-btn');

            const sections = gsap.utils.toArray("section");
            const timelineDots = gsap.utils.toArray(".timeline-dot");

            const bgColors = ['#FCF9EA', '#FCF9EA', '#FBF3D1', '#FBF3D1'];
            const decorContainer = document.getElementById('background-decorations');
            const decorIcons = ['🎓', '📜', '🌸', '✨', '🎉'];
            let decorElements = [];

            function createBackgroundDecorations() {
                for (let i = 0; i < 20; i++) {
                    const iconSpan = document.createElement('span');
                    iconSpan.innerHTML = decorIcons[i % decorIcons.length];
                    iconSpan.style.top = `${gsap.utils.random(5, 95)}%`;
                    iconSpan.style.left = `${gsap.utils.random(5, 95)}%`;
                    iconSpan.style.fontSize = `${gsap.utils.random(1.5, 3.5)}rem`;
                    iconSpan.style.transform = `rotate(${gsap.utils.random(0, 360)}deg)`;
                    decorContainer.appendChild(iconSpan);
                    decorElements.push(iconSpan);
                }
            }

            function startFloatingAnimation() {
                decorElements.forEach(el => {
                    gsap.to(el, {
                        y: gsap.utils.random(-20, 20),
                        x: gsap.utils.random(-15, 15),
                        rotation: gsap.utils.random(-45, 45),
                        duration: gsap.utils.random(4, 8),
                        repeat: -1,
                        yoyo: true,
                        ease: "sine.inOut"
                    });
                });
            }

            createBackgroundDecorations();
            startFloatingAnimation();

            let isAnimating = false;
            let currentSection = 0;
            let wrongAgeInputCount = 0;
            const scrollDuration = 1.0;
            const scrollEase = "power2.inOut";

            function updateTimeline(index) {
                timelineDots.forEach((dot, i) => {
                    if (i === index) {
                        dot.classList.add('active');
                    } else {
                        dot.classList.remove('active');
                    }
                });
            }

            function showCustomPopup(title, content) {
                popupTitle.textContent = title;
                popupContent.textContent = content;
                popup.style.display = 'flex';
                popup.classList.remove('hidden');
                gsap.fromTo(popup, { opacity: 0, scale: 0.8 }, { opacity: 1, scale: 1, duration: 0.3, ease: 'back.out(1.7)' });
            }

            function hideCustomPopup() {
                gsap.to(popup, {
                    opacity: 0, scale: 0.8, duration: 0.3, ease: 'power2.in', onComplete: () => {
                        popup.classList.add('hidden');
                        popup.style.display = 'none';
                    }
                });
            }

            closePopupBtn.addEventListener('click', hideCustomPopup);

            function scrollToSection(index) {
                if (isAnimating) return;
                if (index < 0 || index >= sections.length) return;

                isAnimating = true;
                currentSection = index;
                updateTimeline(currentSection);

                gsap.to('#animated-bg', {
                    backgroundColor: bgColors[index],
                    duration: scrollDuration,
                    ease: scrollEase
                });

                gsap.to(decorElements, {
                    y: (i) => gsap.utils.random(-50, 50),
                    x: (i) => gsap.utils.random(-50, 50),
                    rotation: (i) => `random(${gsap.utils.random(-360, 360)})`,
                    scale: (i) => gsap.utils.random(0.8, 1.5),
                    opacity: (i) => gsap.utils.random(0.1, 0.2),
                    duration: scrollDuration,
                    ease: scrollEase
                });

                gsap.to(window, {
                    scrollTo: {
                        y: sections[index],
                        autoKill: false
                    },
                    duration: scrollDuration,
                    ease: scrollEase,
                    onComplete: () => {
                        setTimeout(() => {
                            isAnimating = false;
                        }, 1500);
                    }
                });
            }

            window.addEventListener('wheel', (e) => {
                if (isAnimating) {
                    e.preventDefault();
                    return;
                }
                if (e.deltaY > 0) {
                    scrollToSection(currentSection + 1);
                } else if (e.deltaY < 0) {
                    scrollToSection(currentSection - 1);
                }
            });

            let touchStartY = 0;
            let touchEndY = 0;

            window.addEventListener('touchstart', (e) => {
                touchStartY = e.changedTouches[0].screenY;
            }, { passive: true });

            window.addEventListener('touchend', (e) => {
                if (isAnimating) return;
                touchEndY = e.changedTouches[0].screenY;
                handleSwipe();
            }, { passive: true });

            function handleSwipe() {
                if (touchEndY < touchStartY - 50) {
                    scrollToSection(currentSection + 1);
                } else if (touchEndY > touchStartY + 50) {
                    scrollToSection(currentSection - 1);
                }
            }

            timelineDots.forEach((dot) => {
                dot.addEventListener('click', () => {
                    const index = parseInt(dot.dataset.index);
                    if (!isAnimating && currentSection !== index) {
                        scrollToSection(index);
                    }
                });
            });

            startAppBtn.addEventListener('click', () => {
                scrollToSection(1);
            });

            toHomeFromHuflitBtn.addEventListener('click', () => {
                scrollToSection(2);
            });

            toGameBtn.addEventListener('click', () => {
                scrollToSection(3);
            });

            toHomeBtn.addEventListener('click', () => {
                resetGame();
                scrollToSection(2);
                hideCustomPopup();
            });


            gsap.set('.gsap-intro-hidden', { opacity: 0, visibility: 'hidden', y: 20, scale: 0.9 });
            const tlIntro = gsap.timeline({
                defaults: { duration: 0.8, ease: 'back.out(1.2)' },
                onComplete: () => {
                    gsap.to('#intro-icon', {
                        y: -10,
                        repeat: -1,
                        yoyo: true,
                        ease: "sine.inOut",
                        duration: 1.5
                    });
                    gsap.to('#start-app-btn', {
                        scale: 1.05,
                        repeat: -1,
                        yoyo: true,
                        ease: "sine.inOut",
                        duration: 1.0,
                        delay: 0.5
                    });
                }
            });

            tlIntro.to('.gsap-intro-hidden', {
                opacity: 1,
                visibility: 'visible',
                y: 0,
                scale: 1,
                stagger: 0.2,
                delay: 0.3
            });

            gsap.set('.gsap-hidden', { opacity: 0, visibility: 'hidden', y: 30, scale: 0.8 });
            function startHomePageAnimation() {
                gsap.set('.gsap-hidden', { opacity: 0, visibility: 'hidden', y: 30, scale: 0.8 });
                const tlHome = gsap.timeline({ defaults: { duration: 0.8, ease: 'back.out(1.2)' } });
                tlHome.to('.gsap-title', { opacity: 1, visibility: 'visible', y: 0, scale: 1, stagger: 0.2 })
                    .to('.gsap-intro', { opacity: 1, visibility: 'visible', y: 0, stagger: 0.2 }, "-=0.5")
                    .to('.gsap-details', { opacity: 1, visibility: 'visible', y: 0, scale: 1 }, "-=0.4")
                    .to('.gsap-button', { opacity: 1, visibility: 'visible', y: 0, scale: 1 }, "-=0.5");
            }
            ScrollTrigger.create({
                trigger: "#page-home",
                start: "top 60%",
                onEnter: startHomePageAnimation,
                onLeaveBack: () => gsap.set('.gsap-hidden', { opacity: 0, visibility: 'hidden', y: 30, scale: 0.8 })
            });

            gsap.set('.gsap-huflit-hidden', { opacity: 0, visibility: 'hidden', y: 30, scale: 0.9 });
            function startHuflitPageAnimation() {
                gsap.set('.gsap-huflit-hidden', { opacity: 0, visibility: 'hidden', y: 30, scale: 0.9 });
                const tlHuflit = gsap.timeline({ defaults: { duration: 0.8, ease: 'back.out(1.2)' } });
                tlHuflit.to('.gsap-huflit-hidden', {
                    opacity: 1,
                    visibility: 'visible',
                    y: 0,
                    scale: 1,
                    stagger: 0.2
                });
            }
            ScrollTrigger.create({
                trigger: "#page-huflit",
                start: "top 60%",
                onEnter: startHuflitPageAnimation,
                onLeaveBack: () => gsap.set('.gsap-huflit-hidden', { opacity: 0, visibility: 'hidden', y: 30, scale: 0.9 })
            });

            gsap.set(gameContainer, { opacity: 0, y: 30, scale: 0.9 });
            function startGamePageAnimation() {
                gsap.set(gameContainer, { opacity: 0, y: 30, scale: 0.9 });
                gsap.to(gameContainer, {
                    opacity: 1,
                    y: 0,
                    scale: 1,
                    duration: 1.0,
                    ease: 'back.out(1.2)'
                });
            }
            ScrollTrigger.create({
                trigger: "#page-game",
                start: "top 60%",
                onEnter: startGamePageAnimation,
                onLeaveBack: () => gsap.set(gameContainer, { opacity: 0, y: 30, scale: 0.9 })
            });

            ageInput.addEventListener('input', (e) => {
                const originalValue = e.target.value;
                let numericValue = originalValue.replace(/[^0-9]/g, '');

                if (numericValue.length > 5) {
                    numericValue = numericValue.substring(0, 5);
                }

                if (originalValue !== numericValue) {
                    wrongAgeInputCount++;
                    e.target.value = numericValue;

                    if (wrongAgeInputCount >= 3) {
                        showCustomPopup("Đùa à :))", "Điền số hẳn hoi coi bro :))");
                        wrongAgeInputCount = 0;
                    }
                }
            });

            const loadingTexts = [
                "Đang phân tích nhân tướng học...",
                "Kiểm tra đường chỉ tay qua... wifi?",
                "Úm ba la xì bùa... Đang kết nối vũ trụ...",
                "Đang kiểm tra phong thuỷ...",
                "Đọc vị 7749 vì sao chiếu mệnh...",
                "Hoàn tất! Chuẩn bị xem tương lai..."
            ];

            gameForm.addEventListener('submit', (e) => {
                e.preventDefault();

                const name = document.getElementById('name').value;
                const email = document.getElementById('email').value;
                const age = document.getElementById('age').value;
                const ageNum = parseInt(age);

                if (!name || !email || !age) {
                    console.error("Vui lòng điền đầy đủ thông tin");
                    gsap.to(gameForm, { x: 10, duration: 0.1, repeat: 3, yoyo: true, ease: "power1.inOut" });
                    return;
                }

                if (ageNum >= 116) {
                    showCustomPopup("Chúc mừng", `Sống tận ${ageNum} tuổi. Cần đi đăng ký kỉ lục Guinness không bro :))`);
                    return;
                }

                const tlGame = gsap.timeline({ defaults: { ease: 'power2.inOut' } });
                tlGame.to([gameForm, gameHeader], {
                    opacity: 0,
                    scale: 0.9,
                    y: -20,
                    duration: 0.5,
                    onComplete: () => {
                        gameForm.classList.add('hidden');
                        gameHeader.classList.add('hidden');
                        loadingSpinner.classList.remove('hidden');
                        gsap.fromTo(loadingSpinner,
                            { opacity: 0, y: 20 },
                            { opacity: 1, y: 0, duration: 0.6, ease: 'power2.out' }
                        );
                    }
                });

                tlGame.call(() => {
                    loadingText.textContent = loadingTexts[0];
                });
                tlGame.to(loadingBar, { width: '20%', duration: 1.5, ease: 'none' });

                tlGame.call(() => {
                    loadingText.textContent = loadingTexts[1];
                });
                tlGame.to(loadingBar, { width: '40%', duration: 1.5, ease: 'none' });

                tlGame.call(() => {
                    loadingText.textContent = loadingTexts[2];
                    sendEmailToServer(name, email);
                });
                tlGame.to(loadingBar, { width: '60%', duration: 1.5, ease: 'none' });

                tlGame.call(() => {
                    loadingText.textContent = loadingTexts[3];
                });
                tlGame.to(loadingBar, { width: '80%', duration: 1.5, ease: 'none' });

                tlGame.call(() => {
                    loadingText.textContent = loadingTexts[4];
                });
                tlGame.to(loadingBar, { width: '100%', duration: 1.0, ease: 'none' });

                tlGame.call(() => {
                    loadingText.textContent = loadingTexts[5];
                });
                tlGame.to({}, { duration: 0.5 });

                tlGame.to(loadingSpinner, {
                    opacity: 0,
                    y: -20,
                    duration: 0.5,
                    onComplete: () => {
                        loadingSpinner.classList.add('hidden');
                        gameResult.classList.remove('hidden');

                        const nextAge = parseInt(age) + 1;
                        resultText.textContent = `Năm sau bạn được... ${nextAge} tuổi!`;

                        gsap.fromTo(gameResult,
                            { opacity: 0, scale: 0.8, y: 20 },
                            { opacity: 1, scale: 1, y: 0, duration: 0.8, ease: 'back.out(1.7)' }
                        );
                    }
                });

                tlGame.to(emailConfirmMsg, { opacity: 1, duration: 1.0, ease: 'power2.out' }, "+=0.5");
                tlGame.call(() => {
                    toHomeBtn.classList.remove('hidden');
                    gsap.fromTo(toHomeBtn,
                        { opacity: 0, y: 20 },
                        { opacity: 1, y: 0, duration: 0.5, ease: 'power2.out' }
                    );
                });
            });

            function sendEmailToServer(name, email) {

                fetch('/api/send-email', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ name, email }),
                })
                    .then(response => response.json())
                    .then(data => {
                    })
                    .catch((error) => {
                    });
            }

            function resetGame() {
                gameForm.reset();
                gameForm.classList.remove('hidden');
                gameHeader.classList.remove('hidden');
                loadingSpinner.classList.add('hidden');
                gameResult.classList.add('hidden');
                toHomeBtn.classList.add('hidden');

                gsap.set(loadingBar, { width: '0%' });
                loadingText.textContent = '';
                gsap.set([gameForm, gameHeader], { opacity: 1, scale: 1, y: 0 });
                gsap.set(emailConfirmMsg, { opacity: 0 });
                gsap.set(loadingSpinner, { opacity: 0, y: 20 });
                gsap.set(gameResult, { opacity: 0, scale: 0.8, y: 20 });
                gsap.set(toHomeBtn, { opacity: 0, y: 20 });

                gsap.set(gameContainer, { opacity: 0, y: 30, scale: 0.9 });
                wrongAgeInputCount = 0;
                hideCustomPopup();
            }
        });
    </script>
</body>

</html>